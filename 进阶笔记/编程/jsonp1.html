<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JSONP实现跨域2</title>
</head>
<body>
    <div id="mydiv">
        <button id="btn">点击</button>
    </div>
</body>
<script type="text/javascript">
    //回调函数，回调函数的名字handleResponse是在请求中指定的，不能随便更改
    function handleResponse(response){
            console.log(response);
    }

</script>
<script type="text/javascript">
    // console.log(document.body.firstChild);   //#text    说明是空文本节点
    window.onload = function() {

    var oBtn = document.getElementById('btn');

    oBtn.onclick = function() {     

        var script = document.createElement("script");
        script.src = "https://api.douban.com/v2/book/search?q=javascript&count=1&callback=handleResponse";  //回调函数在src中设置
        document.body.insertBefore(script, document.body.firstChild); 
        //console.log(script);
        //console.log(document.body.firstChild);  
    };
};

//jsonp实现跨域请求的简单原理：就是动态创建script标签，然后利用script的src不受同源策略的约束来跨域获取数据。


// jsonp有两部分组成: 回调函数和数据。回调函数是在响应到来时应该在页面中调用的函数，回调函数的名字一般是在请求中指定的。而数据就是回调函数中的json数据。通过回调函数来操作数据。


//安全性

//JSONP 是从其他域中加载代码执行。如果其他域不安全，很可能会在响应中夹带一些恶意代码，而此时除了完全放弃 JSONP 调用之外，没有办法追究。因此在使用不是你自己运维的 Web 服务时，一定得保证它安全可靠。

</script>
</html>